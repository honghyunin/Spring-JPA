# 페치 조인과 일반 조인의 차이

- 일반 조인 실행 시 연관된 엔티티를 함께 조회하지 않음

만약 페치 조인을 사용하지 않고 일반 조인만 사용할 경우

연관된 엔티티를 객체로 가져오지만 데이터가 없기 때문에 해당 객체를 사용할 때 DB에서 값을 가져오기 위한 쿼리를 한 번 더 날리게 된다.

- 페치 조인을 사용할 때만 연관된 엔티티도 함께 조회(즉시 로딩)
    - 즉 필요할 떄마다 즉시 로딩을 사용하는 것이 페치 조인.
- 페치 조인은 객체 그래프를 SQL 한 번에 조회하는 개념

## 페치 조인의 특징과 한계

- 연관된 엔티티들을 sql 한 번으로 조회 - 성능 최적화
- 엔티티에 직접 적용하는 글로벌 코딩 전략보다 우선함
    - @OneToMany(fetch = FetchType.Lazy) 글로벌 로딩 전략
- 실무에서 글로벌 로딩 전략은 모두 지연 로딩
- 최적화가 필요한 곳은 페치 조인 적용
- 패치 조인 대상에는 별칭을 줄 수 없다.
    - 하이버네이트는 가능, 가급적 사용X
- 둘 이상의 컬렉션은 페치 조인 할 수 없다.

페치 조인 대상에게 별칭을 주면 안되는 이유

- 애초에 페치 조인 대상에게 별칭을 주어 조건문을 걸어서까지 데이터를 걸러서 조회할 것이라면,  애초에 해당 엔티티로 조회를 하면 되기 때문이다. ( 도서관에서 내가 책이 어디있는 지 알고 있는데 사서선생님께 굳이 물어서 책을 찾는 느낌인듯 하다. )
- 페치 조인은 엔티티와 관련된 모든 것들을 가져오는 것이기 때문에 별칭을 주어 WHERE를 통해 조건문을 실행 해 특정 값만 가져온다는 의미이기 때문이다.
- JPA의 의도는 객체 그래프 탐색에서 연관관계 페치 조인은 해당 연관관계의 엔티티를 모두 조회한다는 뜻이다.

# 정리

- 모든 것을 페치 조인으로 해결할 순 없음
- 페치 조인은 객체 그래프를 유지할 때 사용하면 효과적
- 여러 테이블을 조인해서 엔티티가 가진 모양이 아닌 전혀 다른 결과를 내야 하면, 페치 조인보다는 일반 조인을 사용하고 필요한 데이터들만 조회해서 DTO로 반환하는 것이 효과적

## 궁금한 키워드

- 객체 그래프